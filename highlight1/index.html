<!DOCTYPE html>
<html>
<head>
    <link rel="stylesheet" type="text/css" id="stylesheet" href="atom-one-dark.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script type="text/javascript" src="highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
</head>
<body>
    <pre><code class="html" contenteditable="true" id="code" oninput="highlightAgain(this);" >
        &lt;!DOCTYPE&gt;
        &lt;html&gt;
        &lt;head&gt;
            &lt;title&gt;Highlighter&lt;/title&gt;            
        &lt;/head&gt;
        &lt;body&gt;
        &lt;/body&gt;
        &lt;/html&gt;
    </code></pre>
    <textarea class="textarea" name="name" id="textarea"></textarea>
    
    <script>
        function highlightAgain(el) {
            let savedSel = rangy.saveSelection();
            hljs.highlightBlock(el);
            rangy.restoreSelection(savedSel);            
        }

        $('#code').on('keyup', function (e) {
            $('#textarea').val(e.currentTarget.innerText);
        })
    </script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/rangy/1.3.0/rangy-core.min.js"
        integrity="sha512-N+AGrlJCI4ov6LmtY/2SIm8kAcSAp9lhrYhVFmUhMBuFwQy3xEMNj+cPG4bg0N4XkL7Rw2+sKW8hg8v1MF5yLQ=="
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/rangy/1.3.0/rangy-textrange.min.js"
        integrity="sha512-B/3u37TOSGL4oI7qB11UIZi1QB/TyBmp0eZXvyr1xjA9CikKxLbiedP2nX+mUvzCc8Mfxrpjvviy7xZeO2S5tQ=="
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/rangy/1.3.0/rangy-selectionsaverestore.min.js"
        integrity="sha512-40/cVQ39VPjTs1eG+XPt/iFbY+d3FwiH2YbH/nhy1XDr1i1elaxIM1+r7Xy3MMrz/RCsRTYNXKyJEhu/8AGQlg=="
        crossorigin="anonymous"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
</body>
</html>